# 📱 iOS 独立运行部署教程（保姆级）

## 🎯 目标

- ✅ 电脑关闭也能在 iOS 手机上运行
- ✅ 代码修改后自动同步更新到手机
- ✅ 完全免费，无需服务器

---

## 📋 第一步：准备 GitHub 账号（如果没有）

1. 访问 <https://github.com>
2. 点击右上角 **Sign up** 注册账号（免费）
3. 完成邮箱验证

---

## 📋 第二步：将代码上传到 GitHub

### 2.1 安装 Git（如果还没安装）

1. 访问 <https://git-scm.com/download/win>
2. 下载并安装 Git for Windows
3. 安装时全部选择默认选项即可

### 2.2 在项目文件夹初始化 Git

1. 打开 PowerShell 或命令提示符
2. 进入项目文件夹：

   ```powershell
   cd "F:\小手机"
   ```

3. 初始化 Git 仓库：

   ```powershell
   git init
   ```

4. 创建 .gitignore 文件（已自动创建，跳过此步）

5. 添加所有文件：

   ```powershell
   git add .
   ```

   **⚠️ 如果看到警告信息**（例如：`warning: LF will be replaced by CRLF`）：
   - **这是正常的！** 不是错误，只是 Git 在自动处理 Windows 和 Linux 的行尾格式差异
   - **可以忽略**，直接继续下一步
   - 如果想消除警告，可以先执行：

     ```powershell
     git config core.autocrlf true
     ```

     然后再执行 `git add .`

6. 提交代码：

   ```powershell
   git commit -m "初始提交"
   ```

### 2.3 在 GitHub 上创建仓库

1. 登录 GitHub
2. 点击右上角 **+** 号，选择 **New repository**
3. 填写信息：
   - Repository name: `mini-phone`（或任意名字）
   - Description: `软糯乙女小手机`
   - 选择 **Public**（公开，免费）
   - **不要**勾选 "Initialize this repository with a README"
4. 点击 **Create repository**

### 2.4 将本地代码推送到 GitHub

**⚠️ 重要：确保在项目目录中执行命令！**

1. 首先，确保你在项目文件夹中：

   ```powershell
   cd "F:\小手机"
   ```

2. 然后执行以下命令（GitHub 会显示这些命令，复制并执行）：

   ```powershell
   git remote add origin https://github.com/你的用户名/仓库名.git
   git branch -M main
   git push -u origin main
   ```

**⚠️ 如果看到 `error: remote origin already exists`：**

这表示之前已经添加过远程仓库了。有两种解决方法：

**方法 1：更新远程仓库地址（推荐）**

```powershell
git remote set-url origin https://github.com/你的用户名/仓库名.git
git branch -M main
git push -u origin main
```

**方法 2：删除后重新添加**

```powershell
git remote remove origin
git remote add origin https://github.com/你的用户名/仓库名.git
git branch -M main
git push -u origin main
```

**注意**：将 `你的用户名` 和 `仓库名` 替换为你的实际信息

**⚠️ 如果看到 `fatal: unable to access` 或 `Failed to connect to github.com`：**

这是网络连接问题，常见原因和解决方法：

**方法 1：检查网络连接**

- 确保电脑已连接到互联网
- 尝试在浏览器中访问 <https://github.com，看是否能打开>

**方法 2：使用代理（如果在中国大陆）**
如果你使用代理软件（如 Clash、V2Ray 等），需要配置 Git 使用代理：

```powershell
# 设置 HTTP 代理（将端口改为你的代理端口，通常是 7890 或 1080）
git config --global http.proxy http://127.0.0.1:7890
git config --global https.proxy http://127.0.0.1:7890

# 然后再尝试推送
git push -u origin main
```

**方法 3：使用 SSH 代替 HTTPS（推荐）**
SSH 连接通常更稳定：

1. 生成 SSH 密钥（如果还没有）：

   ```powershell
   ssh-keygen -t ed25519 -C "your_email@example.com"
   ```

   按回车使用默认路径，可以设置密码或直接回车

2. 复制公钥内容：

   ```powershell
   cat ~/.ssh/id_ed25519.pub
   ```

   复制输出的内容

3. 在 GitHub 添加 SSH 密钥：
   - GitHub → 右上角头像 → **Settings**
   - 左侧菜单 → **SSH and GPG keys**
   - 点击 **New SSH key**
   - Title: 任意名称（如：我的电脑）
   - Key: 粘贴刚才复制的公钥
   - 点击 **Add SSH key**

4. 修改远程仓库地址为 SSH：

   ```powershell
   git remote set-url origin git@github.com:你的用户名/仓库名.git
   git push -u origin main
   ```

**方法 4：使用 GitHub Desktop（图形界面，最简单）**
如果命令行太复杂，可以使用 GitHub Desktop：

1. 下载：<https://desktop.github.com>
2. 登录 GitHub 账号
3. 添加本地仓库
4. 点击 Push 按钮

如果提示输入账号密码：

- 用户名：你的 GitHub 用户名
- 密码：需要使用 **Personal Access Token**（见下方说明）

#### 🔑 如何获取 Personal Access Token（如果需要）

1. GitHub 右上角头像 → **Settings**
2. 左侧菜单最下方 → **Developer settings**
3. 左侧菜单 → **Personal access tokens** → **Tokens (classic)**
4. 点击 **Generate new token** → **Generate new token (classic)**
5. 填写：
   - Note: `部署小手机`
   - Expiration: `90 days`（或更长）
   - 勾选 **repo** 权限
6. 点击 **Generate token**
7. **复制生成的 token**（只显示一次，务必保存）
8. 推送代码时，密码处粘贴这个 token

---

## 📋 第三步：在 Vercel 上部署（免费）

### 3.1 注册 Vercel 账号

1. 访问 <https://vercel.com>
2. 点击 **Sign Up**
3. 选择 **Continue with GitHub**（使用 GitHub 账号登录，最简单）
4. 授权 Vercel 访问你的 GitHub

### 3.2 导入项目

1. 登录后，点击 **Add New...** → **Project**
2. 在列表中找到你的 `mini-phone` 仓库
3. 点击 **Import**

### 3.3 配置项目

1. **Framework Preset**: 选择 **Vite**（会自动识别）
2. **Root Directory**: 保持默认（`./`）
3. **Build Command**: 保持默认（`npm run build`）
4. **Output Directory**: 保持默认（`dist`）
5. **Install Command**: 保持默认（`npm install`）

6. 点击 **Deploy**

### 3.4 等待部署完成

- 通常 1-2 分钟即可完成
- 部署成功后，会显示一个网址，例如：`https://mini-phone-xxx.vercel.app`

### 3.5 确保自动部署正常工作（重要！）

如果发现 GitHub 代码更新了，但 Vercel 没有自动部署，按以下步骤解决：

**方法 1：手动触发部署（最简单，推荐）**

1. 在 Vercel 项目页面，点击顶部的 **Deployments** 标签
2. 找到最新的部署记录（即使还是旧的）
3. 点击该部署记录右侧的 **三个点菜单**（⋯）
4. 选择 **Redeploy**
5. 等待 1-2 分钟，会使用 GitHub 上的最新代码重新部署

**方法 2：检查 GitHub Webhook（如果方法 1 不行）**

1. 打开 GitHub 仓库：<https://github.com/你的用户名/仓库名>
2. 点击 **Settings**（仓库设置，在仓库页面顶部）
3. 点击左侧的 **Webhooks**
4. 检查是否已有 Vercel 的 webhook：
   - 如果看到 webhook，URL 应该包含 `vercel.com` 或 `vercel.app`
   - 状态应该是绿色的勾（Active）
   - 如果看到，说明已正确配置，**不需要手动添加**

5. **如果没有看到 Vercel 的 webhook**：
   - **不要在这里手动添加**（很复杂且容易出错）
   - 应该回到 Vercel，重新连接 GitHub（见方法 4）
   - Vercel 会自动创建正确的 webhook

**方法 3：使用 Deploy Hooks（可选）**

如果你想手动控制何时部署：

1. Vercel 项目 → **Settings** → **Git**
2. 滚动到 **Deploy Hooks** 部分
3. 填写：
   - **Name**: 任意名称（如：手动部署）
   - **Branch**: `main`
4. 点击 **Create Hook**
5. 会生成一个 URL，访问这个 URL 就会触发部署

**方法 4：重新连接 GitHub（最后手段）**

如果以上都不行：

1. Vercel 项目 → **Settings** → **Git**
2. 找到 **Connected Git Repository** 部分
3. 点击 **Disconnect** 按钮
4. 然后重新导入项目：
   - 点击 **Add New...** → **Project**
   - 选择你的仓库
   - 点击 **Import**

**注意**：如果仓库已连接（显示 "Connected"），自动部署通常是默认启用的。如果 GitHub 更新后 Vercel 没有自动部署，先尝试**方法 1（手动触发部署）**，这是最快的解决方案。

---

## 📋 第四步：在 iOS 上访问

### 4.1 添加到主屏幕（像 App 一样使用）

1. 在 iPhone 的 Safari 浏览器中打开你的网址
2. 点击底部的 **分享按钮**（方框带向上箭头）
3. 向下滑动，找到 **添加到主屏幕**
4. 点击 **添加到主屏幕**
5. 可以修改名称（例如：小手机）
6. 点击 **添加**

### 4.2 使用

- 现在你的 iPhone 主屏幕上会有一个图标
- 点击图标即可打开，就像原生 App 一样
- **无需电脑，随时可用！**

### 4.3 如果遇到 SSL 错误（ERR_SSL_PROTOCOL_ERROR）

如果手机访问时显示"此站点的连接不安全"或 `ERR_SSL_PROTOCOL_ERROR`，按以下步骤解决：

**方法 1：检查 URL 是否正确**

1. 在 Vercel 项目页面，点击 **Deployments** 标签
2. 找到最新的部署（状态为 "Ready"）
3. 点击部署卡片，查看 **Domains** 部分
4. 使用主域名（通常是 `项目名.vercel.app`），**不要使用预览 URL**
5. 确保 URL 以 `https://` 开头

**方法 2：清除浏览器缓存**

1. 在 Safari 中，点击地址栏
2. 长按刷新按钮
3. 选择 **清除历史记录和网站数据**
4. 或者关闭 Safari，重新打开

**方法 3：等待部署完成**

- 如果部署还在进行中（状态显示 "Building"），等待完成后再访问
- 部署完成后，状态会变为 "Ready"

**方法 4：检查网络环境**

- 尝试切换网络（Wi-Fi ↔ 移动数据）
- 确保网络连接正常
- **如果电脑开着 VPN/梯子能访问，但手机不能访问**：
  - 可能是手机网络环境对 Vercel 的 SSL 证书有限制
  - 尝试在手机上使用 VPN（如果可用）
  - 或者尝试切换不同的网络环境（如移动数据 vs Wi-Fi）

**方法 5：使用正确的生产域名**

- 在 Vercel 项目页面 → **Settings** → **Domains**
- 查看并复制正确的生产域名
- 确保使用 `https://` 协议访问

**方法 6：网络环境问题（如果以上都不行）**

如果确认是网络环境问题（电脑开 VPN 能访问，手机不开 VPN 不能访问）：

1. **在手机上使用 VPN**（如果有的话）
2. **或者考虑使用其他部署平台**：
   - **Netlify**：类似 Vercel，免费，可能在某些网络环境下更稳定
   - **GitHub Pages**：免费，但需要配置
   - **Cloudflare Pages**：免费，全球 CDN，通常访问更稳定

---

## 📋 第五步：代码更新后自动同步

### 5.1 修改代码

1. 在你的电脑上修改代码
2. 保存文件

### 5.2 推送到 GitHub

在项目文件夹中执行：

```powershell
cd "F:\小手机"
git add .
git commit -m "更新功能"
git push
```

### 5.3 自动部署

- Vercel 会自动检测到 GitHub 的更新
- 自动重新构建和部署
- 通常 1-2 分钟后，你的手机上的应用就会自动更新

**注意**：如果手机上的页面没有自动更新，可以：

- 关闭应用，重新打开
- 或者在 Safari 中强制刷新（下拉页面）

---

## 🎉 完成

现在你的小手机应用已经：

- ✅ 可以在 iOS 上独立运行（无需电脑）
- ✅ 代码修改后自动更新
- ✅ 完全免费
- ✅ 全球 CDN 加速，访问速度快

---

## 🔧 常见问题

### Q1: 推送代码时提示 "Failed to connect to github.com"？

这是网络连接问题，解决方法：

1. **检查网络**：确保电脑已连接互联网，浏览器能访问 github.com
2. **使用代理**：如果在中国大陆，可能需要配置 Git 代理（见教程 2.4 节）
3. **使用 SSH**：SSH 连接通常更稳定（见教程 2.4 节）
4. **使用 GitHub Desktop**：图形界面工具，更简单（见教程 2.4 节）

### Q2: 手机访问时显示 "ERR_SSL_PROTOCOL_ERROR" 或"连接不安全"？

这是 SSL 连接错误，解决方法：

1. **检查 URL**：确保使用正确的生产域名（`项目名.vercel.app`），不要使用预览 URL
2. **确保使用 HTTPS**：URL 必须以 `https://` 开头
3. **清除缓存**：Safari → 设置 → 清除历史记录和网站数据
4. **等待部署完成**：如果部署还在进行中，等待状态变为 "Ready"
5. **切换网络**：尝试切换 Wi-Fi 或移动数据
6. **查看正确域名**：Vercel 项目 → Settings → Domains，使用主域名

详细步骤见教程 4.3 节。

### Q3: 部署失败怎么办？

- 检查 `package.json` 中的脚本是否正确
- 查看 Vercel 的部署日志，找到错误信息

### Q4: 手机访问很慢？

- Vercel 使用全球 CDN，通常很快
- 如果慢，可能是网络问题，可以尝试切换网络

### Q5: 如何更新代码？

- 修改代码 → `git add .` → `git commit -m "描述"` → `git push`
- Vercel 会自动部署

### Q6: 可以自定义域名吗？

- 可以！在 Vercel 项目设置中，点击 **Domains**，添加你的域名

### Q7: 如何查看访问统计？

- Vercel 后台可以查看访问量和性能数据

---

## 📞 需要帮助？

如果遇到问题，可以：

1. 查看 Vercel 的部署日志
2. 检查 GitHub 仓库是否正确推送
3. 确认所有步骤都已完成

祝你使用愉快！🎊
